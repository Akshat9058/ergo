<!--

Created by Alvin Wan (alvinwan.com)

* ocean animation from Don Mccurdy

-->
<!DOCTYPE html>
<html>
  <head>
    <title>Ergo | Endless Runner Game in Virtual Reality</title>
    <script src="./aframe.min.js"></script>
    <script src="./ocean.js"></script>
    <script src="./runner.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/alvinwan/aframe-low-poly@0.0.2/dist/aframe-low-poly.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Exo+2:400,600,700" rel="stylesheet">
    <script src="http://mirrorvr.alvinwan.com/mirrorvr.js" type="text/javascript"></script>
    <link href="./style.css" rel="stylesheet">
  </head>
  <body>
    <a-scene fog="type: linear; color: #D0EAF9; near:5; far:20">

      <a-sky color="#a3d0ed"></a-sky>

      <!-- Mixins -->
      <a-assets>
        <a-mixin id="foliage" geometry="
            primitive: cone;
            segments-height: 1;
            segments-radial:4;
            radius-bottom:0.3;"
           material="color:white;flat-shading: true;"></a-mixin>
        <a-mixin id="trunk" geometry="
            primitive: box;
            height:0.5;
            width:0.1;
            depth:0.1;"
           material="color:white;"></a-mixin>
      </a-assets>

      <!-- Lights! -->
      <a-entity light="
          type: directional;
          castShadow: true;
          intensity: 0.4;
          color: #D0EAF9;"
        position="5 3 1"></a-entity>
      <a-light intensity="0.8" type="ambient" position="1 1 1" color="#B4C5EC"></a-light>

      <!-- Camera! -->
      <a-entity id="rig" position="0 1.5 2.5">
        <a-camera wasd-controls-enabled="false" lane-controls></a-camera>
      </a-entity>

      <!-- Action! -->
      <lp-cone class="iceberg" segments-radial="5" segments-height="3" height="1" amplitude-variance="0.25" radius-top="0.15" radius-bottom="0.5" position="3 -0.1 -1.5">
        <a-animation attribute="rotation" from="-5 0 0" to="5 0 0" repeat="indefinite" direction="alternate"></a-animation>
        <a-animation attribute="position" from="3 -0.2 -1.5" to="4 -0.2 -2.5" repeat="indefinite" direction="alternate" dur="12000" easing="linear"></a-animation>
      </lp-cone>
      <lp-cone class="iceberg" segments-radial="7" segments-height="3" height="0.5" amplitude="0.12" radius-top="0.25" radius-bottom="0.35" position="-3 -0.1 -0.5">
        <a-animation attribute="rotation" from="0 0 -5" to="5 0 0" repeat="indefinite" direction="alternate" dur="1500"></a-animation>
        <a-animation attribute="position" from="-4 -0.2 -0.5" to="-2 -0.2 -0.5" repeat="indefinite" direction="alternate" dur="15000" easing="linear"></a-animation>
      </lp-cone>
      <lp-cone class="iceberg" segments-radial="6" segments-height="2" height="0.5" amplitude="0.1" radius-top="0.25" radius-bottom="0.25" position="-5 -0.2 -3.5">
        <a-animation attribute="rotation" from="5 0 -5" to="5 0 0" repeat="indefinite" direction="alternate" dur="800"></a-animation>
        <a-animation attribute="position" from="-3 -0.2 -3.5" to="-5 -0.2 -5.5" repeat="indefinite" direction="alternate" dur="15000" easing="linear"></a-animation>
      </lp-cone>

      <a-ocean depth="50" width="50" amplitude="0" amplitude-variance="0.1" speed="1.5" speed-variance="1" opacity="1" density="50"></a-ocean>
      <a-ocean depth="50" width="50" opacity="0.5" amplitude="0" amplitude-variance="0.15" speed="1.5" speed-variance="1" density="50"></a-ocean>

      <lp-cone scale="2 2 2" shadow position="0 -3.5 -1.5" rotation="90 0 0" radius-top="1.9" radius-bottom="1.9" segments-radial="20" segments-height="20" amplitude="0.05" amplitude-variance="0.05" height="20" emissive="#005DED" emissive-intensity="0.1">
        <a-entity id="tree-container" position="0 .5 -1.5" rotation="-90 0 0">

          <!-- Tell user to turn around if facing the wrong way! -->
          <a-entity id="fence" position="0 0.5 3">
            <lp-cone segments-height="4" segments-radial="7" amplitude="0" amplitude-variance="0.02" radius-top="0.02" radius-bottom="0.05" height="0.5"></lp-cone>
            <a-box width="0.5" height="0.3" depth="0.05" position="0 0.3 0"></a-box>
            <a-text color="#333" width="1.5" height="1.5" font="exo2bold" value="Turn around!" rotation="0 180 0" position="0 0.3 -0.025" anchor="center" align="center"></a-text>
          </a-entity>

          <a-entity id="template-tree-center" class="tree tree-center" shadow scale="0.3 0.3 0.3" position="0 0.6 0">
            <a-entity class="movable" data-tree-index="1" rotation="-5 0 0">
              <a-entity mixin="foliage"></a-entity>
              <a-entity mixin="trunk" position="0 -0.5 0"></a-entity>
              <a-animation attribute="position" ease="linear" from="0 0 -21" to="0 0 5" dur="5000"></a-animation>
            </a-entity>
          </a-entity>

          <a-entity id="template-tree-left" class="tree tree-left" shadow scale="0.3 0.3 0.3" position="-0.5 0.55 0">
            <a-entity class="movable" data-tree-index="0" rotation="0 0 10">
              <a-entity mixin="foliage"></a-entity>
              <a-entity mixin="trunk" position="0 -0.5 0"></a-entity>
              <a-animation attribute="position" ease="linear" from="0 0 -21" to="0 0 5" dur="5000"></a-animation>
            </a-entity>
          </a-entity>

          <a-entity id="template-tree-right" class="tree" shadow scale="0.3 0.3 0.3" position="0.5 0.55 0">
            <a-entity class="movable" data-tree-index="2" rotation="0 -30 -10">
              <a-entity mixin="foliage"></a-entity>
              <a-entity mixin="trunk" position="0 -0.5 0"></a-entity>
              <a-animation attribute="position" ease="linear" from="0 0 -21" to="0 0 5" dur="5000"></a-animation>
            </a-entity>
          </a-entity>

          <a-text id="score" value="" font="exo2bold" height="40" width="40" position="0 1.2 -3" opacity="0.75" anchor="center" align="center"></a-text>

          <a-entity id="player-container">
            <a-sphere id="player" radius="0.05" player>
              <a-animation repeat="indefinite" direction="alternate" attribute="position" ease="ease-in-out" from="0 0.5 0.6" to="0 0.525 0.6"></a-animation>
              <a-animation repeat="indefinite" direction="alternate" attribute="radius" from="0.05" to="0.055" dur="1500"></a-animation>
              <a-light type="point" intensity="0.35" color="#FF440C">
                <a-animation repeat="indefinite" direction="alternate-reverse" attribute="intensity" ease="ease-in-out" from="0.35" to="0.5"></a-animation>
              </a-light>
            </a-sphere>
          </a-entity>
        </a-entity>
      </lp-cone>
    </a-scene>

    <main id="menu-container">
      <div class="game-menu" id="start-menu">
        <h1>Ergo</h1>
        <div class="bar"></div>
        <h2>Endless Runner Game</h2>
        <p class="copy desktop-instructions">Hit any key to start. Move left and right to avoid the trees!</p>
        <p class="copy mobile-tablet-instructions">Point at ball to start. Turn left and right to avoid the trees!</p>
        <p class="copy mobile-tablet-instructions game-start-timer">5</p>
      </div>
      <div class="game-menu" id="game-over">
        <h1 id="game-score">Game Over</h1>
        <h2>Play Again?</h2>
        <p class="copy desktop-instructions">Hit any key to play again.</p>
        <p class="copy mobile-tablet-instructions">Point at the ball for 5 seconds to restart.</p>
        <p class="copy mobile-tablet-instructions game-start-timer">5</p>
      </div>
    </main>
  </body>
</html>
